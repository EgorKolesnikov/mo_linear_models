# Проект “Scalable Linear Models”

## Состав команды
1) Колесников Егор
2) Вильчевский Константин
3) Пиляк Ксения

## План на весь проект
* Изучение лекции, литературы по теме проекта
* Подготовить репозиторий (написать readme и т.д.)
* Реализовать систему обучения линейных моделей, в частности, алгоритмы sgd, ftrl-proximal, adagrad (классификация/регрессия)
* Создать консольную утилиту, с помощью которой можно обучать и сохранять модель, а также считывать модель и применять
* Сравнение модели с аналогами vowpal wabbit и liblinear

## Кто что сделал за семестр
1) Колесников Егор - реализация консольной утилиты, реализация sgd, распараллеливание
2) Вильчевский Константин - реализация ftrl-proximal
3) Пиляк Ксения - реалиация adagrad, тестирование и сравнение с vowpal wabbit и liblinear

## Установка
1) Скачать репозиторий <br>
`git clone https://github.com/EgorKolesnikov/mo_linear_models`
2) Перейти в корень репозитория и выполнить <br>
`make`

## Тесты
Для быстрой проверки работы библиотеки можно запустить небольшие тесты через `./run.sh`, перейдя в папку `/test/`.<br>
Запустятся тесты на классификацию и регрессию на небольших семплах. Датасеты содержат от 100 до 1000 элементов. 
1) Классификация. Линейно разделимая выборка
2) Классификация. Линейно неразделимя выборка
3) Регрессия. Чистая прямая
4) Регрессия. Прямая с небольшим jitter

## Запуск библиотеки
Бинарник лежит в `/bin/lm`. 

Запуск:<br>
`./lm <train|test> <ALGO> <TASK> <DATASET_FILE_PATH> <MODEL_PATH>`<br>
 `ALGO: 'sgd' | 'adagrad' | 'ftrl-proximal'`<br>
 `TASK: 'classification' | 'regression'`

Файл с датасетом должен иметь следующий формат<br>
   _n_entries n_features_<br>
   _feature1,feature2,...,feature_n,label_<br>
   ...

Датасеты, на которых сранивалась работа с vw и liblinear можно найти здесь:<br>
- https://drive.google.com/drive/folders/1YXj-cWoULh5UjMo3Yx5VKCxzljigK1-e?usp=sharing
- https://drive.google.com/file/d/1AxsG1ZSwaKOdCRQI-dr_jaXf_9AaXK58/view?usp=sharing

## Результаты работы утилиты
Нами было произведено сравнение утилиты с библиотеками **vowpal wabbit** и **liblinear** 
по производительности и по качеству обучения. В качестве данных для классификации был взят датасет
avazu. Для регрессии был сгенерирован вручную.
* Классификация на датасете размером 1 000 000. Количество фичей 23<br>

| Характеристика | Библиотека | sgd | adaptive | ftrl | other |
| -------------- | ---------- | --- | -------- | ---- | ---- |
| **Время обучения, с** | _vowpal wabbit_  | 23.162 | 21.968 | 35.339 |
| | _liblinear_  |  | | | 1 m 19 s |
| | _./lm_ | 0.907 | 0.385 | 7m 45s | |
| **Точность, %** | _vowpal wabbit_ | 54 | 54 | 86 | |
| | _liblinear_ | | | | 84 |
| | _./lm_ | 84 | 84 | 84 |  |
* Регрессия на датасете размером 1 000 000. Количество фичей 23<br>

| Характеристика | Библиотека | sgd | adaptive | ftrl | other |
| -------------- | ---------- | --- | -------- | ---- | ---- |
| **Время обучения, с** | _vowpal wabbit_  | 21.774 | 13.193 | 12.223 |
| | _liblinear_  |  | | | 23.083 |
| | _./lm_ | 0.503 | 0.271 | 8m 44s | |
| **Loss** | _vowpal wabbit_ | 0.49 | 0.49 | 0.54 | |
| | _liblinear_ | | | | 0.011 |
| | _./lm_ | 25103 | 20895906 | 20896180 |  |

* Классификация на датасете размером ~28 000 000. Количество фичей 23 

| Характеристика | Библиотека | sgd | adaptive | ftrl | other |
| -------------- | ---------- | --- | -------- | ---- | ---- |
| **Время обучения, с** | _vowpal wabbit_  | 2m 34s | 2m 13s | 2m 12s |
| | _liblinear_  |  | | | seg<br>fault |
| | _./lm_ | 0.332 | 0.246 | 6m 16s | |
| **Точность, %** | _vowpal wabbit_ | 84 | 84 | 84 | |
| | _liblinear_ | | | |  |
| | _./lm_ | 84 | 84 | 84 |  |